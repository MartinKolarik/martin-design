<input type="text" id="search-input" class="form-control input-lg" placeholder="Search in more than {{count}} open source projects" value="{{query}}">
<p class="show-more"><a href='#!{"query":"*"}'>Browse all projects</a></p>

<script type="text/javascript">
	component.exports = {
		'data'		: {
			'query'	: ''
		},
		'computed'	: {
			'count'	: function() {
				// TODO-LATER
				return Math.floor(JSON.parse(window.localStorage.getItem('__//api.jsdelivr.com/v1/jsdelivr/libraries__data')).datums.length / 50) * 50
			}
		},
		'complete'	: function() {
			var app		= this.get('app');
			var algolia	= new AlgoliaSearch('DBMBXHNL8O', 'ff534b434664d2fb939eace2877ec4dc');
			var index	= algolia.initIndex('jsdelivr');

			// update results on input
			this.observe('query', function(newValue) {
				index.search(newValue.toString(), function(success, list) {
					// select the last version of the project by default
					app.views.searchResults.set('projects', $.extend(true, [], list.hits.map(function(project) {
						project.selectedVersion = project.lastversion;
						return project;
					})));
				}, { 'hitsPerPage': 10 })
			}, { 'init': false });

			// auto focus on load
			$('#search-input').focus();

			// restore query from hash
			$(window).triggerHandler('searchReady');
		}
	};
</script>