<modal id="{{id}}" title="{{title}}" project="{{project}}" buttons="{{buttons}}" submit="{{submit}}">
	<ol id="file-list">
		{{#files:i}}
			<li>
				<input type="checkbox" class="checkbox primary" id="file{{i}}" value="{{this}}" checked="{{this === project.mainfile}}">
				<label for="file{{i}}">{{this}}</label>
			</li>
		{{/files}}
	</ol>
</modal>

<script type="text/javascript">
	var modal			= require('rvc!components/modal');

	component.exports	= {
		'el'		: 'body',
		'append'	: true,
		'components': {
			'modal'	: modal
		},
		'data'		: {
			'callback'	: null,
			'id'		: 'modal-select-files',
			'title'		: 'Select files to include',
			'project'	: {},
			'buttons'	: [
				{
					'label'		: 'cancel',
					'class'		: 'btn-default',
					'handler'	: 'cancel'
				},
				{
					'label'		: 'select',
					'class'		: 'primary',
					'handler'	: 'submit'
				}
			]
		},
		'init'	: function() {
			var _this			= this;
			var selectedVersion = this.get('project').selectedVersion;

			this.set('files', this.get('project').assets.filter(function(asset) {
				return asset.version === selectedVersion;
			})[0].files);

			this.set('submit', function() {
				var files = Array.prototype.slice.call($('#' + _this.get('id'))
					.find('input:checked'))
					.map(function(element) {
						return element.value
					});

				if(files.length && typeof this.get('callback') === 'function') {
					this.get('callback')($.extend($.extend(true, {}, _this.get('project')), {
						'selectedFiles'	: files
					}));
				}
			});
		}
	};
</script>